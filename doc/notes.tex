\documentclass[english,11pt,a4paper]{article}

\input{macros}

\usepackage{a4wide}
\usepackage{tikz}

\title{pdsolver Notes}
\usepackage{amsmath,epsfig,amssymb,amsbsy}

\begin{document}
\maketitle

\section{Problem class and scaling}
The class of problems considered within this framework is given as the following:
\begin{equation}
  \underset{x \in \bbR^n, z \in \bbR^m} \min ~ g( \Tau^{\frac{1}{2}} x) + f(\Sigma^{-\frac{1}{2}} z), \quad \text{s.t.} \quad z = \Sigma^{\frac{1}{2}} K \Tau^{\frac{1}{2}} x.
  \label{eq:scaled_problem}
\end{equation}
Here $g : \bbR^n \to \bbRext$ and $f : \bbR^m \to \bbRext$ are convex, proper, closed functions. $K \in \bbR^{m \times n}$ is a matrix and $\Tau \in \bbR^{n \times n}$, $\Sigma \in \bbR^{m \times m}$ are symmetric positive definite scaling (preconditioning) matrices. The dual problem of \eqref{eq:scaled_problem} is given as
\begin{equation}
  \underset{y \in \bbR^m, w \in \bbR^n} \max ~ -g^*(\Tau^{-\frac{1}{2}} w) - f^*(\Sigma^{\frac{1}{2}} y), \quad \text{s.t.} \quad w=-\Tau^{\frac{1}{2}} K^T \Sigma^{\frac{1}{2}} y.
  \label{eq:scaled_dual_problem}
\end{equation}
Note that the scaled problems can be written using the substitutions
\begin{equation}
  \begin{aligned}
    &\widehat x = \Tau^{-\frac{1}{2}} x, \\
    &\widehat z = \Sigma^{\frac{1}{2}} z, \\
    &\widehat y = \Sigma^{-\frac{1}{2}} y, \\
    &\widehat w = \Tau^{\frac{1}{2}} w, \\
    &\widehat g = g \circ \Tau^{\frac{1}{2}}, \\
    &\widehat f = f \circ \Sigma^{-\frac{1}{2}}, \\
    &\widehat K = \Sigma^{\frac{1}{2}} K \Tau^{\frac{1}{2}}.
  \end{aligned}
\end{equation}

\section{Backends}
\subsection{Primal-Dual Hybrid Gradient Method}
The algorithm is given as:
\begin{equation}
  \begin{aligned}
    &x^{k+1} = (I + \tau \Tau \partial g)^{-1}(x^k - \tau \Tau K^T y^k),\\
    &y^{k+1} = (I + \sigma \Sigma \partial f^*)^{-1}(y^k + \sigma \Sigma K (x^{k+1} + \theta (x^{k+1} - x^k))).\\
  \end{aligned}
  \label{eq:pdhgm}
\end{equation}
The additional variables $w$ and $z$ are given as the following:
\begin{equation}
  \begin{aligned}
    &w^{k+1} = \frac{\Tau^{-1}(x^k - x^{k+1})}{\tau} - K^T y^k,\\
    &z^{k+1} = \frac{\Sigma^{-1}(y^k - y^{k+1})}{\sigma} + K (x^{k+1} + \theta (x^{k+1} - x^k)).
  \end{aligned}
  \label{eq:pdhgm_zw}
\end{equation}

The method produces a sequence of iterates
$(x^k, z^k, y^k, w^k)$ converging to a solution of the (unscaled) primal and dual problem. As a stopping criterion, we consider the 
primal and dual residuals of the scaled problem:
\begin{equation}
  r_p^{k+1} = \norm{\widehat K \widehat x^{k+1} - \widehat z^{k+1}} = \norm{\Sigma^{\frac{1}{2}} (K x^{k+1} - z^{k+1})} = \norm{Kx^{k+1} - z^{k+1}}_{\Sigma},
\end{equation}
\begin{equation}
  r_d^{k+1} = \norm{\widehat K^T \widehat y^{k+1} + \widehat w^{k+1}} = \norm{\Tau^{\frac{1}{2}} (K^T y^{k+1} + w^{k+1})} = \norm{K^T y^{k+1} + w^{k+1}}_{\Tau}.
\end{equation}
In particular, the algorithm is stopped if $r_p < \varepsilon_a + \varepsilon_r \norm{z^{k+1}}_{\Sigma}$ and $r_d < \varepsilon_a + \varepsilon_r \norm{w^{k+1}}_{\Tau}$ for some $\varepsilon_a, \varepsilon_r > 0$.

\end{document}
